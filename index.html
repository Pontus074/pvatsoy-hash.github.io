<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Överlevnadsön 🏝️</title>
<style>
body {margin:0;font-family:Arial;background:#87ceeb;color:white;text-align:center;overflow:hidden;}
canvas{display:block;margin:0 auto;background:#228B22;}
#menu,#gameOverScreen{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.8);padding:20px;border-radius:10px;display:none;}
button{background:#1abc9c;border:none;padding:12px 25px;margin:10px;color:white;font-size:16px;border-radius:5px;cursor:pointer;}
button:hover{background:#16a085;}
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="500"></canvas>

<div id="menu">
  <h2>🏝️ Överlevnadsön 🏝️</h2>
  <p>Rör dig med WASD, piltangenter eller finger/mus.</p>
  <button onclick="startGame()">Starta spelet</button>
</div>

<div id="gameOverScreen">
  <h2>Game Over!</h2>
  <p id="finalScore"></p>
  <button onclick="startGame()">Spela igen</button>
  <button onclick="goHome()">Till start</button>
</div>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");

let player={x:400,y:250,width:30,height:30,health:100,hunger:100};
let keys={up:false,down:false,left:false,right:false};
let items=[],enemies=[],score=0,playing=false;
let spawnInterval,enemyInterval;

// Spelares hastighet
const playerSpeed=3;

// Starta spelet
function startGame(){
    player.x=400; player.y=250; player.health=100; player.hunger=100;
    items=[]; enemies=[]; score=0;
    spawnItems();
    spawnEnemies();
    playing=true;
    document.getElementById("menu").style.display="none";
    document.getElementById("gameOverScreen").style.display="none";
    gameLoop();
}

// Återgå till menyn
function goHome(){
    playing=false;
    document.getElementById("menu").style.display="block";
    document.getElementById("gameOverScreen").style.display="none";
    ctx.clearRect(0,0,canvas.width,canvas.height);
    clearInterval(spawnInterval);
    clearInterval(enemyInterval);
}

// Slut på spelet
function gameOver(){
    playing=false;
    document.getElementById("finalScore").textContent="Din poäng: "+score;
    document.getElementById("gameOverScreen").style.display="block";
    clearInterval(spawnInterval);
    clearInterval(enemyInterval);
}

// Objekt
function spawnItems(){
    spawnInterval=setInterval(()=>{
        if(items.length<10){
            let type=Math.random()>0.5?"food":"wood";
            items.push({x:Math.random()*(canvas.width-20),y:Math.random()*(canvas.height-20),type:type,width:20,height:20});
        }
    },2000);
}

// Fiender
function spawnEnemies(){
    enemyInterval=setInterval(()=>{
        if(enemies.length<5){
            enemies.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,width:25,height:25,dx:(Math.random()>0.5?1:-1)*1.5,dy:(Math.random()>0.5?1:-1)*1.5});
        }
    },3000);
}

// Uppdatera spelare
function updatePlayer(){
    if(keys.up) player.y-=playerSpeed;
    if(keys.down) player.y+=playerSpeed;
    if(keys.left) player.x-=playerSpeed;
    if(keys.right) player.x+=playerSpeed;
    player.x=Math.max(0,Math.min(canvas.width-player.width,player.x));
    player.y=Math.max(0,Math.min(canvas.height-player.height,player.y));
    
    // Hunger minskar över tid
    player.hunger-=0.05;
    if(player.hunger<=0) player.health-=0.2;
    if(player.health<=0) gameOver();
}

// Kollision
function isColliding(a,b){
    return a.x<a.x+b.width && a.x+a.width>b.x && a.y<a.y+b.height && a.y+a.height>b.y;
}

// Game loop
function gameLoop(){
    if(!playing) return;
    ctx.clearRect(0,0,canvas.width,canvas.height);

    // Rita spelare
    ctx.fillStyle="yellow";
    ctx.fillRect(player.x,player.y,player.width,player.height);

    // Rita items
    items.forEach((item,i)=>{
        ctx.fillStyle=item.type==="food"?"red":"brown";
        ctx.fillRect(item.x,item.y,item.width,item.height);
        if(player.x<item.x+item.width && player.x+player.width>item.x &&
           player.y<item.y+item.height && player.y+player.height>item.y){
            if(item.type==="food"){ player.hunger=Math.min(100,player.hunger+20); score+=1; }
            else{ score+=1; }
            items.splice(i,1);
        }
    });

    // Rita fiender
    enemies.forEach((enemy,i)=>{
        enemy.x+=enemy.dx;
        enemy.y+=enemy.dy;
        if(enemy.x<0||enemy.x+enemy.width>canvas.width) enemy.dx*=-1;
        if(enemy.y<0||enemy.y+enemy.height>canvas.height) enemy.dy*=-1;
        ctx.fillStyle="red";
        ctx.fillRect(enemy.x,enemy.y,enemy.width,enemy.height);

        if(player.x<enemy.x+enemy.width && player.x+player.width>enemy.x &&
           player.y<enemy.y+enemy.height && player.y+player.height>enemy.y){
            player.health-=0.5;
        }
    });

    // HUD
    ctx.fillStyle="white";
    ctx.font="16px Arial";
    ctx.fillText("Poäng: "+Math.floor(score),10,20);
    ctx.fillText("Hälsa: "+Math.floor(player.health),10,40);
    ctx.fillText("Hunger: "+Math.floor(player.hunger),10,60);

    updatePlayer();
    requestAnimationFrame(gameLoop);
}

// Tangentbord
document.addEventListener("keydown",e=>{
    if(e.key==="ArrowUp"||e.key==="w") keys.up=true;
    if(e.key==="ArrowDown"||e.key==="s") keys.down=true;
    if(e.key==="ArrowLeft"||e.key==="a") keys.left=true;
    if(e.key==="ArrowRight"||e.key==="d") keys.right=true;
});
document.addEventListener("keyup",e=>{
    if(e.key==="ArrowUp"||e.key==="w") keys.up=false;
    if(e.key==="ArrowDown"||e.key==="s") keys.down=false;
    if(e.key==="ArrowLeft"||e.key==="a") keys.left=false;
    if(e.key==="ArrowRight"||e.key==="d") keys.right=false;
});

// Touch
let touchX=0,touchY=0;
canvas.addEventListener("touchstart",e=>{touchX=e.touches[0].clientX; touchY=e.touches[0].clientY;});
canvas.addEventListener("touchmove",e=>{
    e.preventDefault();
    let dx=e.touches[0].clientX-touchX;
    let dy=e.touches[0].clientY-touchY;
    player.x+=dx*0.1;
    player.y+=dy*0.1;
    touchX=e.touches[0].clientX;
    touchY=e.touches[0].clientY;
});

document.getElementById("menu").style.display="block";
</script>
</body>
</html>

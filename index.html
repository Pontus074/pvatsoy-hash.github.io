<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>Överlevnadsön 3D Test</title>
<style>
body { margin:0; overflow:hidden; }
canvas { display:block; }
#hud { position:absolute; top:10px; left:10px; color:white; font-family:sans-serif; }
</style>
</head>
<body>
<div id="hud">Hälsa: 100 | Tid: Dag</div>
<script src="https://cdn.jsdelivr.net/npm/three@0.152.0/build/three.min.js"></script>

<script>
// Scen och kamera
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb); // himmelblå
let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);

let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// Mark
let groundGeo = new THREE.PlaneGeometry(200, 200);
let groundMat = new THREE.MeshPhongMaterial({color:0x228B22});
let ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI/2;
scene.add(ground);

// Ljus
let sun = new THREE.DirectionalLight(0xffffff, 1);
sun.position.set(50,100,50);
scene.add(sun);

let ambient = new THREE.AmbientLight(0x404040,0.5);
scene.add(ambient);

// Spelare
let player = {x:0, y:2, z:0, health:100};

// Träd
function addTree(x,z){
    let trunkGeo = new THREE.CylinderGeometry(0.3,0.3,3);
    let trunkMat = new THREE.MeshPhongMaterial({color:0x8B4513});
    let trunk = new THREE.Mesh(trunkGeo,trunkMat);
    trunk.position.set(x,1.5,z);
    scene.add(trunk);

    let leavesGeo = new THREE.ConeGeometry(1.5,3,8);
    let leavesMat = new THREE.MeshPhongMaterial({color:0x228B22});
    let leaves = new THREE.Mesh(leavesGeo,leavesMat);
    leaves.position.set(x,4.5,z);
    scene.add(leaves);
}
for(let i=0;i<20;i++){
    addTree(Math.random()*100-50,Math.random()*100-50);
}

// Tangentbord
let moveForward=false, moveBackward=false, moveLeft=false, moveRight=false;
document.addEventListener('keydown', e=>{
    if(e.key==='w') moveForward=true;
    if(e.key==='s') moveBackward=true;
    if(e.key==='a') moveLeft=true;
    if(e.key==='d') moveRight=true;
});
document.addEventListener('keyup', e=>{
    if(e.key==='w') moveForward=false;
    if(e.key==='s') moveBackward=false;
    if(e.key==='a') moveLeft=false;
    if(e.key==='d') moveRight=false;
});

// Spelarrörelse
function updatePlayer(){
    let speed=0.2;
    if(moveForward) player.z -= speed;
    if(moveBackward) player.z += speed;
    if(moveLeft) player.x -= speed;
    if(moveRight) player.x += speed;
}

// Dag/natt
let isDay = true;
let timeCounter = 0;

// Render-loop
function animate(){
    requestAnimationFrame(animate);
    updatePlayer();

    // Kamera följer spelaren
    camera.position.set(player.x,player.y+1,player.z+5);
    camera.lookAt(player.x,player.y,player.z);

    // Dag/natt-cykel
    timeCounter += 0.01;
    if(timeCounter>20){ isDay = !isDay; timeCounter=0; }
    sun.intensity = isDay?1:0.2;
    ambient.intensity = isDay?0.5:0.1;
    document.getElementById("hud").innerText = `Hälsa: ${player.health} | Tid: ${isDay?'Dag':'Natt'}`;

    renderer.render(scene,camera);
}
animate();

window.addEventListener('resize', ()=>{
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
